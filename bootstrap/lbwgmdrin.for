      SUBROUTINE FNDOWN(KPOINT_OWN,IUNIT,IDUMMY,NOROOM)
      IMPLICIT NONE
      INTEGER*4 IBB(10240000)
      INTEGER*2 IBBW(2,10240000)
      BYTE IBBB(4,10240000)
      REAL*8 CBB(5120000)
      REAL FBB(10240000)
      INTEGER IBBP(6,170)
      EQUIVALENCE (IBB,FBB,CBB,IBBW,IBBB)
      EQUIVALENCE (IBB(1025),IBBP)
      COMMON /BBOARD/ IBB
cpar$ private / BBoard / ! keep FORTRAN from assigning a global section
      INTEGER ISNAP_D , ISNAP_BEFORE_1 , ISNAP_BEFORE_2 , ISNAP_AFTER_1 
     *, ISNAP_AFTER_2
      COMMON / SNAP_COMMON / ISNAP_D , ISNAP_BEFORE_1 , ISNAP_BEFORE_2 ,
     * ISNAP_AFTER_1 , ISNAP_AFTER_2
cpar$ private / snap_common / ! no FORTRAN global section
      INTEGER KPOINT_OWN,IUNIT,NOROOM
      INTEGER IDUMMY
      INTEGER KPOINT_UNT,I_UNT_OWNINDX
      INTEGER FOUND_FLAG,EMPTY_SLOT
      INTEGER I_OWN_UNIT
      FOUND_FLAG =0
      NOROOM =0
      EMPTY_SLOT =0
      KPOINT_UNT=IBBP(1,01)-104+(104)*(IUNIT)
      I_UNT_OWNINDX=(IAND(ISHFT(IBB(KPOINT_UNT+25),-(14)),'3FFF'X))
      IF(.NOT.((I_UNT_OWNINDX.GT.0).AND.(I_UNT_OWNINDX.LE.10000)))GOTO 2
     *3000
      KPOINT_OWN=IBBP(1,57)-19+(19)*(I_UNT_OWNINDX)
      I_OWN_UNIT=(IAND(ISHFT(IBB(KPOINT_OWN+7),-(0)),'FFFF'X))
      IF(.NOT.(I_OWN_UNIT.EQ.IUNIT))GOTO 23002
      FOUND_FLAG =1
23002 CONTINUE
23000 CONTINUE
      IF(.NOT.(FOUND_FLAG.EQ.0))GOTO 23004
      KPOINT_OWN=IBBP(1,57)
23006 IF(.NOT.((KPOINT_OWN.GE.IBBP(1,57).AND.KPOINT_OWN.LE.(IBBP(1,57)+I
     *BBP(3,57)-1))))GOTO 23008
      I_OWN_UNIT=(IAND(ISHFT(IBB(KPOINT_OWN+7),-(0)),'FFFF'X))
      IF(.NOT.(I_OWN_UNIT.EQ.IUNIT))GOTO 23009
      FOUND_FLAG =1
      I_UNT_OWNINDX=((KPOINT_OWN-IBBP(1,57))/19+1)
      IBB(KPOINT_UNT+25)=IOR(IAND(IBB(KPOINT_UNT+25),NOT(ISHFT('3FFF'X,1
     *4))),ISHFT(IAND((I_UNT_OWNINDX),'3FFF'X),14))
      GOTO 23008
23009 CONTINUE
      IF(.NOT.(I_OWN_UNIT.EQ.0.AND.EMPTY_SLOT.EQ.0))GOTO 23011
      EMPTY_SLOT =KPOINT_OWN
23011 CONTINUE
23010 CONTINUE
23007 KPOINT_OWN=KPOINT_OWN+19
      GOTO 23006
23008 CONTINUE
      IF(.NOT.(FOUND_FLAG.EQ.0))GOTO 23013
      IF(.NOT.(EMPTY_SLOT.NE.0))GOTO 23015
      KPOINT_OWN=EMPTY_SLOT
      I_UNT_OWNINDX=((KPOINT_OWN-IBBP(1,57))/19+1)
      IBB(KPOINT_UNT+25)=IOR(IAND(IBB(KPOINT_UNT+25),NOT(ISHFT('3FFF'X,1
     *4))),ISHFT(IAND((I_UNT_OWNINDX),'3FFF'X),14))
      GOTO 23016
23015 CONTINUE
      NOROOM =1
23016 CONTINUE
23013 CONTINUE
23004 CONTINUE
      RETURN
      END
      SUBROUTINE RPPOS1(KPOINT_UNT,SUBROU,KPOINT_OWN,IFIRST,NOROOM)
      IMPLICIT NONE
      INTEGER*4 IBB(10240000)
      INTEGER*2 IBBW(2,10240000)
      BYTE IBBB(4,10240000)
      REAL*8 CBB(5120000)
      REAL FBB(10240000)
      INTEGER IBBP(6,170)
      EQUIVALENCE (IBB,FBB,CBB,IBBW,IBBB)
      EQUIVALENCE (IBB(1025),IBBP)
      COMMON /BBOARD/ IBB
cpar$ private / BBoard / ! keep FORTRAN from assigning a global section
      INTEGER ISNAP_D , ISNAP_BEFORE_1 , ISNAP_BEFORE_2 , ISNAP_AFTER_1 
     *, ISNAP_AFTER_2
      COMMON / SNAP_COMMON / ISNAP_D , ISNAP_BEFORE_1 , ISNAP_BEFORE_2 ,
     * ISNAP_AFTER_1 , ISNAP_AFTER_2
cpar$ private / snap_common / ! no FORTRAN global section
      REAL*4 F_UNT_BATTERYCHARGE,F_OWN_LATITUDE,F_OWN_LONGITUDE,F_OWN_LA
     *UNCHTIME,F_OWN_RECOVERYTIME
      INTEGER IFIRST,NOROOM,KPOINT_PAT,INDX_UNT,KPOINT_UNT,I_UNT_ATTACKI
     *NDX
      INTEGER KPOINT_OWN,I_OWN_EMCONINDX,I_OWN_UNIT,I_OWN_VIEW,I_OWN_GUI
     *DE,I_OWN_ROE,I_OWN_TYPE,I_OWN_SUBTYPE,I_OWN_AIRCAPABLE,I_OWN_STATU
     *S,I_OWN_SPEED,I_OWN_GUIDERANGE,I_OWN_GUIDEBEARING,I_OWN_COURSE,I_O
     *WN_NUCFREE,I_OWN_OWNINTERVAL,I_OWN_SHIPTRACKINTERVAL,I_OWN_AIRTRAC
     *KINTERVAL,I_OWN_ESMTRACKINTERVAL,I_OWN_VIOLATEEMCON,I_OWN_CIRCUIT1
     *,I_OWN_CIRCUIT2,I_OWN_ALTITUDE,I_OWN_NBRAC,I_OWN_NBRACTOT,KPOINT_A
     *CC,I_OWN_ACCPNTR,INDEX_UNT_TNK,I_OWN_PERCENTFUEL,I_OWN_FUELWARNING
     *,I_OWN_MISSION,INDEX_OWN_TNK,I_OWN_ASSIGNEDTARGET,I_OWN_BLIPCM,I_O
     *WN_JAMCM,I_OWN_RBOCCM,I_OWN_DECEPTIONCM,I_OWN_MAST,I_OWN_WIRE,I_OW
     *N_WIREBUOY,I_OWN_DEPTH,F_OWN_TIMEOVERTARGET
      REAL*4     F_UNT_GUIDERANGE
      CALL SUBROU(KPOINT_OWN,IFIRST, 2,NOROOM)
      IF(.NOT.(NOROOM.NE.0))GOTO 23017
      RETURN
23017 CONTINUE
      INDX_UNT =((KPOINT_UNT-IBBP(1,01))/104+1)
      I_OWN_UNIT=INDX_UNT
      IBB(KPOINT_OWN+7)=IOR(IAND(IBB(KPOINT_OWN+7),NOT(ISHFT('FFFF'X,0))
     *),ISHFT(IAND((I_OWN_UNIT),'FFFF'X),0))
      I_OWN_VIEW=(IAND(ISHFT(IBB(KPOINT_UNT+16),-(28)),'000F'X))
      IBB(KPOINT_OWN+10)=IOR(IAND(IBB(KPOINT_OWN+10),NOT(ISHFT('00FF'X,0
     *))),ISHFT(IAND((I_OWN_VIEW),'00FF'X),0))
      I_OWN_EMCONINDX=(IAND(ISHFT(IBB(KPOINT_UNT+43),-(25)),'003F'X))
      IBB(KPOINT_OWN+11)=IOR(IAND(IBB(KPOINT_OWN+11),NOT(ISHFT('007F'X,0
     *))),ISHFT(IAND((I_OWN_EMCONINDX),'007F'X),0))
      I_OWN_GUIDE=(IAND(ISHFT(IBB(KPOINT_UNT+37),-(0)),'FFFF'X))
      IBB(KPOINT_OWN+12)=IOR(IAND(IBB(KPOINT_OWN+12),NOT(ISHFT('FFFF'X,1
     *6))),ISHFT(IAND((I_OWN_GUIDE),'FFFF'X),16))
      I_OWN_TYPE=(IAND(ISHFT(IBB(KPOINT_UNT+16),-(20)),'00FF'X))
      IBB(KPOINT_OWN+10)=IOR(IAND(IBB(KPOINT_OWN+10),NOT(ISHFT('00FF'X,1
     *1))),ISHFT(IAND((I_OWN_TYPE),'00FF'X),11))
      I_OWN_SUBTYPE=(IAND(ISHFT(IBB(KPOINT_UNT+16),-(17)),'0007'X))
      IBB(KPOINT_OWN+10)=IOR(IAND(IBB(KPOINT_OWN+10),NOT(ISHFT('0007'X,8
     *))),ISHFT(IAND((I_OWN_SUBTYPE),'0007'X),8))
      I_OWN_AIRCAPABLE=(IAND(ISHFT(IBB(KPOINT_UNT+22),-(27)),'0001'X))
      IBB(KPOINT_OWN+9)=IOR(IAND(IBB(KPOINT_OWN+9),NOT(ISHFT('0001'X,29)
     *)),ISHFT(IAND((I_OWN_AIRCAPABLE),'0001'X),29))
      CALL UNTSTA (KPOINT_UNT,I_OWN_STATUS)
      IBB(KPOINT_OWN+10)=IOR(IAND(IBB(KPOINT_OWN+10),NOT(ISHFT('001F'X,1
     *9))),ISHFT(IAND((I_OWN_STATUS),'001F'X),19))
      I_OWN_ROE=(IAND(ISHFT(IBB(KPOINT_UNT+41),-(28)),'000F'X))
      IBB(KPOINT_OWN+7)=IOR(IAND(IBB(KPOINT_OWN+7),NOT(ISHFT('000F'X,28)
     *)),ISHFT(IAND((I_OWN_ROE),'000F'X),28))
      I_OWN_NUCFREE=(IAND(ISHFT(IBB(KPOINT_UNT+65),-(30)),'0001'X))
      IBB(KPOINT_OWN+8)=IOR(IAND(IBB(KPOINT_OWN+8),NOT(ISHFT('0001'X,29)
     *)),ISHFT(IAND((I_OWN_NUCFREE),'0001'X),29))
      F_OWN_LATITUDE=FBB(KPOINT_UNT+68)
      FBB(KPOINT_OWN+1)=(F_OWN_LATITUDE)
      F_OWN_LONGITUDE=FBB(KPOINT_UNT+69)
      FBB(KPOINT_OWN+2)=(F_OWN_LONGITUDE)
      F_UNT_GUIDERANGE=FBB(KPOINT_UNT+56)
      IF(.NOT.(F_UNT_GUIDERANGE.LT.1.0))GOTO 23019
      I_OWN_GUIDERANGE=F_UNT_GUIDERANGE*2026+.5
      GOTO 23020
23019 CONTINUE
      I_OWN_GUIDERANGE=F_UNT_GUIDERANGE+.5
23020 CONTINUE
      IBB(KPOINT_OWN+13)=IOR(IAND(IBB(KPOINT_OWN+13),NOT(ISHFT('07FF'X,0
     *))),ISHFT(IAND((I_OWN_GUIDERANGE),'07FF'X),0))
      I_OWN_GUIDEBEARING=FBB(KPOINT_UNT+55)*180./3.141592654+.5
      IBB(KPOINT_OWN+11)=IOR(IAND(IBB(KPOINT_OWN+11),NOT(ISHFT('01FF'X,7
     *))),ISHFT(IAND((I_OWN_GUIDEBEARING),'01FF'X),7))
      I_OWN_COURSE=FBB(KPOINT_UNT+29)*180./3.141592654+.5
      IBB(KPOINT_OWN+3)=IOR(IAND(IBB(KPOINT_OWN+3),NOT(ISHFT('01FF'X,0))
     *),ISHFT(IAND((I_OWN_COURSE),'01FF'X),0))
      I_OWN_SPEED=FBB(KPOINT_UNT+31)+.5
      IBB(KPOINT_OWN+7)=IOR(IAND(IBB(KPOINT_OWN+7),NOT(ISHFT('0FFF'X,16)
     *)),ISHFT(IAND((I_OWN_SPEED),'0FFF'X),16))
      IBB(KPOINT_OWN+9)=IOR(IAND(IBB(KPOINT_OWN+9),NOT(ISHFT('0001'X,28)
     *)),ISHFT(IAND((IOR('00000001'X,(IAND(ISHFT(IBB(KPOINT_OWN+9),-(28)
     *),'0001'X)))),'0001'X),28))
      I_OWN_OWNINTERVAL=(IAND(ISHFT(IBB(KPOINT_UNT+59),-(0)),'FFFF'X))
      IBB(KPOINT_OWN+16)=IOR(IAND(IBB(KPOINT_OWN+16),NOT(ISHFT('FFFF'X,1
     *6))),ISHFT(IAND((I_OWN_OWNINTERVAL),'FFFF'X),16))
      I_OWN_SHIPTRACKINTERVAL=(IAND(ISHFT(IBB(KPOINT_UNT+44),-(0)),     
     *'FFFF'X))
      IBB(KPOINT_OWN+16)=IOR(IAND(IBB(KPOINT_OWN+16),NOT(ISHFT('FFFF'X,0
     *))),ISHFT(IAND((I_OWN_SHIPTRACKINTERVAL),'FFFF'X),0))
      I_OWN_AIRTRACKINTERVAL=(IAND(ISHFT(IBB(KPOINT_UNT+44),-(16)),     
     *'FFFF'X))
      IBB(KPOINT_OWN+9)=IOR(IAND(IBB(KPOINT_OWN+9),NOT(ISHFT('FFFF'X,0))
     *),ISHFT(IAND((I_OWN_AIRTRACKINTERVAL),'FFFF'X),0))
      I_OWN_ESMTRACKINTERVAL=(IAND(ISHFT(IBB(KPOINT_UNT+26),-(16)),     
     *'FFFF'X))
      IBB(KPOINT_OWN+5)=IOR(IAND(IBB(KPOINT_OWN+5),NOT(ISHFT('FFFF'X,16)
     *)),ISHFT(IAND((I_OWN_ESMTRACKINTERVAL),'FFFF'X),16))
      I_OWN_VIOLATEEMCON=(IAND(ISHFT(IBB(KPOINT_UNT+66),-(31)),'0001'X))
      IBB(KPOINT_OWN+10)=IOR(IAND(IBB(KPOINT_OWN+10),NOT(ISHFT('0001'X,3
     *1))),ISHFT(IAND((I_OWN_VIOLATEEMCON),'0001'X),31))
      IF(.NOT.((IAND(ISHFT(IBB(KPOINT_UNT+66),-(30)),'0001'X)).EQ.0.AND.
     *(IAND(ISHFT(IBB(KPOINT_UNT+45),-(6)),'0001'X)).EQ.1))GOTO 23021
      KPOINT_PAT=(IAND(ISHFT(IBB(KPOINT_UNT+38),-(0)),'FFFF'X)+IBBP(1,45
     *))
      I_OWN_CIRCUIT1=(IAND(ISHFT(IBB(KPOINT_PAT+2),-(19)),'007F'X))
      KPOINT_PAT=(IAND(ISHFT(IBB(KPOINT_UNT+38),-(16)),'FFFF'X)+IBBP(1,4
     *5))
      I_OWN_CIRCUIT2=(IAND(ISHFT(IBB(KPOINT_PAT+2),-(19)),'007F'X))
      GOTO 23022
23021 CONTINUE
      I_OWN_CIRCUIT1=0
      I_OWN_CIRCUIT2=0
23022 CONTINUE
      IBB(KPOINT_OWN+9)=IOR(IAND(IBB(KPOINT_OWN+9),NOT(ISHFT('003F'X,16)
     *)),ISHFT(IAND((I_OWN_CIRCUIT1),'003F'X),16))
      IBB(KPOINT_OWN+9)=IOR(IAND(IBB(KPOINT_OWN+9),NOT(ISHFT('003F'X,22)
     *)),ISHFT(IAND((I_OWN_CIRCUIT2),'003F'X),22))
      IF(.NOT.(I_OWN_TYPE.EQ.1))GOTO 23023
      I_OWN_ALTITUDE=((IAND(ISHFT(IBB(KPOINT_UNT+61),-(0)),'1FFFFF'X))+5
     *0) / 100
      IBB(KPOINT_OWN+3)=IOR(IAND(IBB(KPOINT_OWN+3),NOT(ISHFT('1FFFFF'X,1
     *1))),ISHFT(IAND((I_OWN_ALTITUDE),'1FFFFF'X),11))
      I_OWN_NBRAC=(IAND(ISHFT(IBB(KPOINT_UNT+65),-(0)),'00FF'X))
      IBB(KPOINT_OWN+8)=IOR(IAND(IBB(KPOINT_OWN+8),NOT(ISHFT('00FF'X,16)
     *)),ISHFT(IAND((I_OWN_NBRAC),'00FF'X),16))
      I_OWN_NBRACTOT=(IAND(ISHFT(IBB(KPOINT_UNT+65),-(8)),'007F'X))
      IBB(KPOINT_OWN+8)=IOR(IAND(IBB(KPOINT_OWN+8),NOT(ISHFT('00FF'X,8))
     *),ISHFT(IAND((I_OWN_NBRACTOT),'00FF'X),8))
      KPOINT_ACC=(IAND(ISHFT(IBB(KPOINT_UNT+22),-(0)),'7FFFFF'X)+IBBP(1,
     *32))
      I_OWN_ACCPNTR=KPOINT_ACC
      IBB(KPOINT_OWN+13)=IOR(IAND(IBB(KPOINT_OWN+13),NOT(ISHFT(         
     *'01FFFF'X,15))),ISHFT(IAND((I_OWN_ACCPNTR-IBBP(1,32)),'01FFFF'X),1
     *5))
      INDEX_UNT_TNK=1
      I_OWN_PERCENTFUEL=FBB((KPOINT_UNT+102+(INDEX_UNT_TNK-1)*1))*100. /
     * (IAND(ISHFT(IBB(KPOINT_ACC+15),-(0)),'07FFFF'X))+.5
      I_OWN_PERCENTFUEL=MIN(I_OWN_PERCENTFUEL,255)
      IBB(KPOINT_OWN+8)=IOR(IAND(IBB(KPOINT_OWN+8),NOT(ISHFT('00FF'X,0))
     *),ISHFT(IAND((I_OWN_PERCENTFUEL),'00FF'X),0))
      I_OWN_FUELWARNING=(IAND(ISHFT(IBB(KPOINT_UNT+45),-(1)),'0001'X))
      IBB(KPOINT_OWN+10)=IOR(IAND(IBB(KPOINT_OWN+10),NOT(ISHFT('0001'X,3
     *0))),ISHFT(IAND((I_OWN_FUELWARNING),'0001'X),30))
      I_OWN_MISSION=(IAND(ISHFT(IBB(KPOINT_UNT+43),-(19)),'003F'X))
      IBB(KPOINT_OWN+10)=IOR(IAND(IBB(KPOINT_OWN+10),NOT(ISHFT('003F'X,2
     *4))),ISHFT(IAND((I_OWN_MISSION),'003F'X),24))
      F_OWN_LAUNCHTIME=(IAND(ISHFT(IBB(KPOINT_UNT+39),-(0)),'07FFFFFF'X)
     **1.0*0.001)
      IBB(KPOINT_OWN+4)=IOR(IAND(IBB(KPOINT_OWN+4),NOT(ISHFT('FFFF'X,16)
     *)),ISHFT(IAND(INT(0.5+(F_OWN_LAUNCHTIME)/1.0),'FFFF'X),16))
      F_OWN_RECOVERYTIME=(IAND(ISHFT(IBB(KPOINT_UNT+40),-(0)),          
     *'07FFFFFF'X)*1.0*0.001)
      IBB(KPOINT_OWN+4)=IOR(IAND(IBB(KPOINT_OWN+4),NOT(ISHFT('FFFF'X,0))
     *),ISHFT(IAND(INT(0.5+(F_OWN_RECOVERYTIME)/1.0),'FFFF'X),0))
      I_OWN_ASSIGNEDTARGET=(IAND(ISHFT(IBB(KPOINT_UNT+43),-(0)),'FFFF'X)
     *)
      IBB(KPOINT_OWN+12)=IOR(IAND(IBB(KPOINT_OWN+12),NOT(ISHFT('FFFF'X,0
     *))),ISHFT(IAND((I_OWN_ASSIGNEDTARGET),'FFFF'X),0))
      I_UNT_ATTACKINDX=(IAND(ISHFT(IBB(KPOINT_UNT+67),-(16)),'FFFF'X))
      IF(.NOT.(I_UNT_ATTACKINDX.EQ.0))GOTO 23025
      F_OWN_TIMEOVERTARGET=0
      GOTO 23026
23025 CONTINUE
      IF(.NOT.(I_UNT_ATTACKINDX.EQ.I_OWN_ASSIGNEDTARGET))GOTO 23027
      F_OWN_TIMEOVERTARGET=FBB(KPOINT_UNT+85)
      GOTO 23028
23027 CONTINUE
      F_OWN_TIMEOVERTARGET=0
23028 CONTINUE
23026 CONTINUE
      FBB(KPOINT_OWN+15)=(F_OWN_TIMEOVERTARGET)
      GOTO 23024
23023 CONTINUE
      IF(.NOT.(I_OWN_TYPE.EQ.5))GOTO 23029
      I_OWN_ALTITUDE=((IAND(ISHFT(IBB(KPOINT_UNT+61),-(0)),'1FFFFF'X))+5
     *0) / 100
      IBB(KPOINT_OWN+3)=IOR(IAND(IBB(KPOINT_OWN+3),NOT(ISHFT('1FFFFF'X,1
     *1))),ISHFT(IAND((I_OWN_ALTITUDE),'1FFFFF'X),11))
      IBB(KPOINT_OWN+4)=IOR(IAND(IBB(KPOINT_OWN+4),NOT(ISHFT('FFFF'X,16)
     *)),ISHFT(IAND(INT(0.5+((IAND(ISHFT(IBB(KPOINT_UNT+39),-(0)),      
     *'07FFFFFF'X)*1.0*0.001))/1.0),'FFFF'X),16))
      IBB(KPOINT_OWN)=IOR(IAND(IBB(KPOINT_OWN),NOT(ISHFT('03FFFF'X,0))),
     *ISHFT(IAND((0),'03FFFF'X),0))
      IBB(KPOINT_OWN+9)=IOR(IAND(IBB(KPOINT_OWN+9),NOT(ISHFT('0001'X,28)
     *)),ISHFT(IAND((IOR('00000001'X,(IAND(ISHFT(IBB(KPOINT_OWN+9),-(28)
     *),'0001'X)))),'0001'X),28))
      IBB(KPOINT_OWN+11)=IOR(IAND(IBB(KPOINT_OWN+11),NOT(ISHFT('FFFF'X,1
     *6))),ISHFT(IAND((0),'FFFF'X),16))
      IBB(KPOINT_OWN+9)=IOR(IAND(IBB(KPOINT_OWN+9),NOT(ISHFT('0001'X,28)
     *)),ISHFT(IAND((IOR('00000001'X,(IAND(ISHFT(IBB(KPOINT_OWN+9),-(28)
     *),'0001'X)))),'0001'X),28))
      GOTO 23030
23029 CONTINUE
      IF(.NOT.(I_OWN_TYPE.EQ.7))GOTO 23031
      INDEX_OWN_TNK=2
      INDEX_UNT_TNK=2
      CALL LIB$MOVC3( 1*4,IBB((KPOINT_UNT+102+(INDEX_UNT_TNK-1)*1)),IBB(
     *(KPOINT_OWN+17+(INDEX_OWN_TNK-1)*1)) )
      INDEX_OWN_TNK=1
      INDEX_UNT_TNK=1
      CALL LIB$MOVC3( 1*4,IBB((KPOINT_UNT+102+(INDEX_UNT_TNK-1)*1)),IBB(
     *(KPOINT_OWN+17+(INDEX_OWN_TNK-1)*1)) )
      IBB(KPOINT_OWN+8)=IOR(IAND(IBB(KPOINT_OWN+8),NOT(ISHFT('001F'X,24)
     *)),ISHFT(IAND(((IAND(ISHFT(IBB(KPOINT_UNT+79),-(16)),'001F'X))),  
     *'001F'X),24))
      IBB(KPOINT_OWN+4)=IOR(IAND(IBB(KPOINT_OWN+4),NOT(ISHFT('FFFF'X,16)
     *)),ISHFT(IAND(INT(0.5+(FBB(KPOINT_UNT+83))/1.0),'FFFF'X),16))
      IBB(KPOINT_OWN+4)=IOR(IAND(IBB(KPOINT_OWN+4),NOT(ISHFT('FFFF'X,0))
     *),ISHFT(IAND(INT(0.5+((IAND(ISHFT(IBB(KPOINT_UNT+40),-(0)),       
     *'07FFFFFF'X)*1.0*0.001))/1.0),'FFFF'X),0))
      GOTO 23032
23031 CONTINUE
      CALL CMEAS(INDX_UNT,I_OWN_BLIPCM,I_OWN_JAMCM,I_OWN_RBOCCM,I_OWN_DE
     *CEPTIONCM)
      IBB(KPOINT_OWN+13)=IOR(IAND(IBB(KPOINT_OWN+13),NOT(ISHFT('0001'X,1
     *4))),ISHFT(IAND((I_OWN_BLIPCM),'0001'X),14))
      IBB(KPOINT_OWN+13)=IOR(IAND(IBB(KPOINT_OWN+13),NOT(ISHFT('0001'X,1
     *2))),ISHFT(IAND((I_OWN_JAMCM),'0001'X),12))
      IBB(KPOINT_OWN+13)=IOR(IAND(IBB(KPOINT_OWN+13),NOT(ISHFT('0001'X,1
     *1))),ISHFT(IAND((I_OWN_RBOCCM),'0001'X),11))
      IBB(KPOINT_OWN+13)=IOR(IAND(IBB(KPOINT_OWN+13),NOT(ISHFT('0001'X,1
     *3))),ISHFT(IAND((I_OWN_DECEPTIONCM),'0001'X),13))
      IF(.NOT.(I_OWN_TYPE.EQ.2))GOTO 23033
      CALL UDDET ((IAND(ISHFT(IBB(KPOINT_UNT+63),-(30)),'0001'X)),FBB(KP
     *OINT_UNT+82),I_OWN_MAST)
      IBB(KPOINT_OWN+3)=IOR(IAND(IBB(KPOINT_OWN+3),NOT(ISHFT('0003'X,9))
     *),ISHFT(IAND((I_OWN_MAST),'0003'X),9))
      CALL UDDET ((IAND(ISHFT(IBB(KPOINT_UNT+63),-(29)),'0001'X)),FBB(KP
     *OINT_UNT+83),I_OWN_WIRE)
      IBB(KPOINT_OWN+8)=IOR(IAND(IBB(KPOINT_OWN+8),NOT(ISHFT('0003'X,30)
     *)),ISHFT(IAND((I_OWN_WIRE),'0003'X),30))
      CALL UDDET ((IAND(ISHFT(IBB(KPOINT_UNT+63),-(28)),'0001'X)),FBB(KP
     *OINT_UNT+86),I_OWN_WIREBUOY)
      IBB(KPOINT_OWN+9)=IOR(IAND(IBB(KPOINT_OWN+9),NOT(ISHFT('0003'X,30)
     *)),ISHFT(IAND((I_OWN_WIREBUOY),'0003'X),30))
      F_UNT_BATTERYCHARGE=(IAND(ISHFT(IBB(KPOINT_UNT+64),-(0)),         
     *'0FFFFF'X)*1.0*0.0001)
      I_OWN_PERCENTFUEL=INT(F_UNT_BATTERYCHARGE)
      IBB(KPOINT_OWN+8)=IOR(IAND(IBB(KPOINT_OWN+8),NOT(ISHFT('00FF'X,0))
     *),ISHFT(IAND((I_OWN_PERCENTFUEL),'00FF'X),0))
      I_OWN_FUELWARNING=(IAND(ISHFT(IBB(KPOINT_UNT+45),-(1)),'0001'X))
      IBB(KPOINT_OWN+10)=IOR(IAND(IBB(KPOINT_OWN+10),NOT(ISHFT('0001'X,3
     *0))),ISHFT(IAND((I_OWN_FUELWARNING),'0001'X),30))
      I_OWN_DEPTH=(IAND(ISHFT(IBB(KPOINT_UNT+61),-(0)),'1FFFFF'X))
      IBB(KPOINT_OWN+3)=IOR(IAND(IBB(KPOINT_OWN+3),NOT(ISHFT('1FFFFF'X,1
     *1))),ISHFT(IAND((I_OWN_DEPTH),'1FFFFF'X),11))
      GOTO 23034
23033 CONTINUE
      INDEX_OWN_TNK=2
      INDEX_UNT_TNK=2
      CALL LIB$MOVC3( 1*4,IBB((KPOINT_UNT+102+(INDEX_UNT_TNK-1)*1)),IBB(
     *(KPOINT_OWN+17+(INDEX_OWN_TNK-1)*1)) )
      INDEX_OWN_TNK=1
      INDEX_UNT_TNK=1
      CALL LIB$MOVC3( 1*4,IBB((KPOINT_UNT+102+(INDEX_UNT_TNK-1)*1)),IBB(
     *(KPOINT_OWN+17+(INDEX_OWN_TNK-1)*1)) )
      IBB(KPOINT_OWN+8)=IOR(IAND(IBB(KPOINT_OWN+8),NOT(ISHFT('001F'X,24)
     *)),ISHFT(IAND(((IAND(ISHFT(IBB(KPOINT_UNT+79),-(16)),'001F'X))),  
     *'001F'X),24))
      IF(.NOT.((IAND(ISHFT(IBB(KPOINT_UNT+16),-(17)),'07FF'X)).NE.(ISHFT
     *(3,3)+1)))GOTO 23035
      IBB(KPOINT_OWN+4)=IOR(IAND(IBB(KPOINT_OWN+4),NOT(ISHFT('FFFF'X,16)
     *)),ISHFT(IAND(INT(0.5+(FBB(KPOINT_UNT+83))/1.0),'FFFF'X),16))
      IBB(KPOINT_OWN+4)=IOR(IAND(IBB(KPOINT_OWN+4),NOT(ISHFT('FFFF'X,0))
     *),ISHFT(IAND(INT(0.5+((IAND(ISHFT(IBB(KPOINT_UNT+40),-(0)),       
     *'07FFFFFF'X)*1.0*0.001))/1.0),'FFFF'X),0))
23035 CONTINUE
23034 CONTINUE
23032 CONTINUE
23030 CONTINUE
23024 CONTINUE
      RETURN
      END
      SUBROUTINE ADDINV(KPOINT_INV,IFIRST,IDUMMY,NOROOM)
      IMPLICIT NONE
      INTEGER*4 IBB(10240000)
      INTEGER*2 IBBW(2,10240000)
      BYTE IBBB(4,10240000)
      REAL*8 CBB(5120000)
      REAL FBB(10240000)
      INTEGER IBBP(6,170)
      EQUIVALENCE (IBB,FBB,CBB,IBBW,IBBB)
      EQUIVALENCE (IBB(1025),IBBP)
      COMMON /BBOARD/ IBB
cpar$ private / BBoard / ! keep FORTRAN from assigning a global section
      INTEGER ISNAP_D , ISNAP_BEFORE_1 , ISNAP_BEFORE_2 , ISNAP_AFTER_1 
     *, ISNAP_AFTER_2
      COMMON / SNAP_COMMON / ISNAP_D , ISNAP_BEFORE_1 , ISNAP_BEFORE_2 ,
     * ISNAP_AFTER_1 , ISNAP_AFTER_2
cpar$ private / snap_common / ! no FORTRAN global section
      INTEGER IDUMMY,IFIRST,INDEXX,NOROOM,KPOINT_INV,I_INV_NEXTINDX
      NOROOM =0
      INDEXX=IBB(248)
      IF(.NOT.(INDEXX.EQ.0))GOTO 23037
      NOROOM =1
      RETURN
23037 CONTINUE
      IF(.NOT.(IFIRST.EQ.0))GOTO 23039
      IFIRST =INDEXX
      GOTO 23040
23039 CONTINUE
      I_INV_NEXTINDX=INDEXX
      IBB(KPOINT_INV)=IOR(IAND(IBB(KPOINT_INV),NOT(ISHFT('03FFFF'X,0))),
     *ISHFT(IAND((I_INV_NEXTINDX),'03FFFF'X),0))
23040 CONTINUE
      KPOINT_INV=IBBP(1,62)-21+(21)*INDEXX
      IBB(248)=(IAND(ISHFT(IBB(KPOINT_INV),-(0)),'03FFFF'X))
      I_INV_NEXTINDX=0
      IBB(KPOINT_INV)=IOR(IAND(IBB(KPOINT_INV),NOT(ISHFT('03FFFF'X,0))),
     *ISHFT(IAND((I_INV_NEXTINDX),'03FFFF'X),0))
      RETURN
      END
      SUBROUTINE RPINV1(KPOINT_UNT,SUBROU,KPOINT_INV,IFIRST,NOROOM)
      IMPLICIT NONE
      INTEGER*4 IBB(10240000)
      INTEGER*2 IBBW(2,10240000)
      BYTE IBBB(4,10240000)
      REAL*8 CBB(5120000)
      REAL FBB(10240000)
      INTEGER IBBP(6,170)
      EQUIVALENCE (IBB,FBB,CBB,IBBW,IBBB)
      EQUIVALENCE (IBB(1025),IBBP)
      COMMON /BBOARD/ IBB
cpar$ private / BBoard / ! keep FORTRAN from assigning a global section
      INTEGER ISNAP_D , ISNAP_BEFORE_1 , ISNAP_BEFORE_2 , ISNAP_AFTER_1 
     *, ISNAP_AFTER_2
      COMMON / SNAP_COMMON / ISNAP_D , ISNAP_BEFORE_1 , ISNAP_BEFORE_2 ,
     * ISNAP_AFTER_1 , ISNAP_AFTER_2
cpar$ private / snap_common / ! no FORTRAN global section
      REAL TIME,F_BML_TIMELAUNCH
      INTEGER I,J,IFIRST,ITIME,ICODE2,ICNT,ISEXP,NOROOM,KPOINT_DEQ,I_DEQ
     *_IDENT,I_DEQ_PNTR,I_DEQ_REMAINING,KPOINT_INV,INDEX_INV_EXP,I_INV_E
     *XP_TYPE,KPOINT_UNT,I_UNT_BMLINDX,I_UNT_TYPE,I_UNT_SUPERTYPE,KPOINT
     *_BML,I_BML_STATUS
      INTEGER IACPNT ( 40)
      INTEGER IQUANT ( 8, 40)
      INTEGER ICODE ( 8)
      EXTERNAL SUBROU
      DATA ICODE/ 1, 2, 3,4, 11,10,12,13/
      INDEX_INV_EXP=0
      KPOINT_DEQ=IBBP(1,03)-6+(6)*((KPOINT_UNT-IBBP(1,01))/104+1)
23041 IF(.NOT.(KPOINT_DEQ.GE.IBBP(1,03)))GOTO 23043
      I_DEQ_IDENT=(IAND(ISHFT(IBB(KPOINT_DEQ+2),-(0)),'00FF'X))
      CALL EXPTST (I_DEQ_IDENT,ISEXP)
      IF(.NOT.(ISEXP.EQ.0))GOTO 23044
      GOTO 23042
23044 CONTINUE
      I_DEQ_PNTR=(IAND(ISHFT(IBB(KPOINT_DEQ),-(12)),'0FFFFF'X)+IBBP(1,34
     *))
      I_DEQ_REMAINING=(IAND(ISHFT(IBB(KPOINT_DEQ+1),-(13)),'07FFFF'X))
      I_INV_EXP_TYPE= 5
      IF(.NOT.(I_DEQ_IDENT.EQ.34))GOTO 23046
      I_INV_EXP_TYPE= 9
23046 CONTINUE
      CALL WRTINV(SUBROU,KPOINT_INV,INDEX_INV_EXP,IFIRST,NOROOM,I_INV_EX
     *P_TYPE,I_DEQ_PNTR,I_DEQ_REMAINING)
23042 KPOINT_DEQ=IBBP(1,03)-6+(6)*(IAND(ISHFT(IBB(KPOINT_DEQ+2),-(8)),  
     *'0FFFFF'X))
      GOTO 23041
23043 CONTINUE
      I_UNT_TYPE=(IAND(ISHFT(IBB(KPOINT_UNT+16),-(20)),'00FF'X))
      I_UNT_BMLINDX=(IAND(ISHFT(IBB(KPOINT_UNT+60),-(0)),'07FF'X))
      I_UNT_SUPERTYPE=(IAND(ISHFT(IBB(KPOINT_UNT+16),-(17)),'07FF'X))
      IF(.NOT.(I_UNT_BMLINDX.NE.0.AND.I_UNT_SUPERTYPE.NE.(ISHFT(3,3)+1))
     *)GOTO 23048
      KPOINT_BML=IBBP(1,85)-8+(8)*I_UNT_BMLINDX
23050 IF(.NOT.(KPOINT_BML.GE.IBBP(1,85)))GOTO 23052
      I_BML_STATUS=(IAND(ISHFT(IBB(KPOINT_BML+3),-(23)),'000F'X))
      IF(.NOT.(I_BML_STATUS.NE.2))GOTO 23053
      GOTO 23051
23053 CONTINUE
      F_BML_TIMELAUNCH=FBB(KPOINT_BML+5)
      TIME =F_BML_TIMELAUNCH-FBB(461)
      IF(.NOT.(TIME.LE.0.))GOTO 23055
      ITIME =0
      ICODE2 = 7
      GOTO 23056
23055 CONTINUE
      ICODE2 = 8
23056 CONTINUE
      CALL WRTINV_BML (SUBROU,KPOINT_INV,INDEX_INV_EXP,IFIRST,NOROOM,ICO
     *DE2,KPOINT_BML,INT(TIME))
23051 KPOINT_BML=IBBP(1,85)-8+(8)*(IAND(ISHFT(IBB(KPOINT_BML+7),-(14)), 
     *'07FF'X))
      GOTO 23050
23052 CONTINUE
23048 CONTINUE
      IF(.NOT.((IAND(ISHFT(IBB(KPOINT_UNT+22),-(27)),'0001'X)).EQ.0))GOT
     *O 23057
      RETURN
23057 CONTINUE
      CALL BLDAVA(((KPOINT_UNT-IBBP(1,01))/104+1),IACPNT,IQUANT,ICNT)
      I=1 
23059 IF(.NOT.(I.LE.ICNT))GOTO 23061
      J=1 
23062 IF(.NOT.(J.LE. 8))GOTO 23064
      CALL WRTINV(SUBROU,KPOINT_INV,INDEX_INV_EXP,IFIRST,NOROOM,ICODE(J)
     *,IACPNT(I),IQUANT(J,I))
23063 J=J+1
      GOTO 23062
23064 CONTINUE
23060 I=I+1
      GOTO 23059
23061 CONTINUE
      RETURN
      END
      SUBROUTINE WRTINV_BML(SUBROU,KPOINT_INV,INDEX_INV_EXP,IFIRST,NOROO
     *M,I_INV_EXP_TYPE,I_INV_EXP_BMLPNTR,I_INV_EXP_TIMEREMAINING)
      IMPLICIT NONE
      INTEGER*4 IBB(10240000)
      INTEGER*2 IBBW(2,10240000)
      BYTE IBBB(4,10240000)
      REAL*8 CBB(5120000)
      REAL FBB(10240000)
      INTEGER IBBP(6,170)
      EQUIVALENCE (IBB,FBB,CBB,IBBW,IBBB)
      EQUIVALENCE (IBB(1025),IBBP)
      COMMON /BBOARD/ IBB
cpar$ private / BBoard / ! keep FORTRAN from assigning a global section
      INTEGER ISNAP_D , ISNAP_BEFORE_1 , ISNAP_BEFORE_2 , ISNAP_AFTER_1 
     *, ISNAP_AFTER_2
      COMMON / SNAP_COMMON / ISNAP_D , ISNAP_BEFORE_1 , ISNAP_BEFORE_2 ,
     * ISNAP_AFTER_1 , ISNAP_AFTER_2
cpar$ private / snap_common / ! no FORTRAN global section
      INTEGER IFIRST,NOROOM,KPOINT_INV,I_INV_EXP_TIMEREMAINING,INDEX_INV
     *_EXP,I_INV_EXP_TYPE,I_INV_EXP_BMLPNTR
      INDEX_INV_EXP=INDEX_INV_EXP+1
      IF(.NOT.(INDEX_INV_EXP.GT.10))GOTO 23065
      INDEX_INV_EXP=1
23065 CONTINUE
      IF(.NOT.(INDEX_INV_EXP.EQ.1))GOTO 23067
      CALL SUBROU(KPOINT_INV,IFIRST, 3,NOROOM)
      IF(.NOT.(NOROOM.NE.0))GOTO 23069
      RETURN
23069 CONTINUE
23067 CONTINUE
      IBB((KPOINT_INV+1+(INDEX_INV_EXP-1)*2))=IOR(IAND(IBB((KPOINT_INV+1
     *+(INDEX_INV_EXP-1)*2)),NOT(ISHFT('000F'X,20))),ISHFT(IAND((I_INV_E
     *XP_TYPE),'000F'X),20))
      IBB((KPOINT_INV+1+(INDEX_INV_EXP-1)*2))=IOR(IAND(IBB((KPOINT_INV+1
     *+(INDEX_INV_EXP-1)*2)),NOT(ISHFT('0FFFFF'X,0))),ISHFT(IAND((I_INV_
     *EXP_BMLPNTR-IBBP(1,85)),'0FFFFF'X),0))
      IBB((KPOINT_INV+1+(INDEX_INV_EXP-1)*2)+1)=IOR(IAND(IBB((KPOINT_INV
     *+1+(INDEX_INV_EXP-1)*2)+1),NOT(ISHFT('07FF'X,0))),ISHFT(IAND((I_IN
     *V_EXP_TIMEREMAINING),'07FF'X),0))
      RETURN
      END
      SUBROUTINE BLDAVA(IUNIT,IACPNT,IQUANT,ICNT)
      IMPLICIT NONE
      INTEGER*4 IBB(10240000)
      INTEGER*2 IBBW(2,10240000)
      BYTE IBBB(4,10240000)
      REAL*8 CBB(5120000)
      REAL FBB(10240000)
      INTEGER IBBP(6,170)
      EQUIVALENCE (IBB,FBB,CBB,IBBW,IBBB)
      EQUIVALENCE (IBB(1025),IBBP)
      COMMON /BBOARD/ IBB
cpar$ private / BBoard / ! keep FORTRAN from assigning a global section
      INTEGER ISNAP_D , ISNAP_BEFORE_1 , ISNAP_BEFORE_2 , ISNAP_AFTER_1 
     *, ISNAP_AFTER_2
      COMMON / SNAP_COMMON / ISNAP_D , ISNAP_BEFORE_1 , ISNAP_BEFORE_2 ,
     * ISNAP_AFTER_1 , ISNAP_AFTER_2
cpar$ private / snap_common / ! no FORTRAN global section
      REAL LDLY,F_AML_TIMEMAINT,F_AML_TIMELAUNCH
      INTEGER LAST,KPOINT_AML,I_AML_STATUS,I_AML_OWNERINDX,I_AML_ACCPNTR
      INTEGER IUNIT
      INTEGER IACPNT( 40)
      INTEGER IQUANT( 8, 40)
      INTEGER ICNT
      INTEGER J,J2
      INTEGER K
      INTEGER L
      INTEGER I
      ICNT =0
      J2=1
23071 IF(.NOT.(J2.LE. 40))GOTO 23073
      IACPNT(J2) =0
      J=1
23074 IF(.NOT.(J.LE. 8))GOTO 23076
      IQUANT(J,J2) =0
23075 J=J+1
      GOTO 23074
23076 CONTINUE
23072 J2=J2+1
      GOTO 23071
23073 CONTINUE
      LAST =IBBP(1,04)+IBBP(3,04)
      KPOINT_AML=IBBP(1,04)
23077 IF(.NOT.(KPOINT_AML.LT.LAST))GOTO 23079
      I_AML_OWNERINDX=(IAND(ISHFT(IBB(KPOINT_AML+3),-(16)),'FFFF'X))
      IF(.NOT.(I_AML_OWNERINDX.NE.IUNIT))GOTO 23080
      GOTO 23078
23080 CONTINUE
      I_AML_STATUS=(IAND(ISHFT(IBB(KPOINT_AML+4),-(12)),'0007'X))
      IF(.NOT.(I_AML_STATUS.EQ.2))GOTO 23082
      F_AML_TIMELAUNCH=FBB(KPOINT_AML+6)
      LDLY =F_AML_TIMELAUNCH-FBB(461)
      F_AML_TIMEMAINT=FBB(KPOINT_AML+7)
      IF(.NOT.(LDLY.GT.30..AND.F_AML_TIMEMAINT.LE.FBB(461)))GOTO 23084
      K=5
      GOTO 23085
23084 CONTINUE
      IF(.NOT.(LDLY.GT.30.))GOTO 23086
      K=6
      GOTO 23087
23086 CONTINUE
      IF(.NOT.(LDLY.GT.15.))GOTO 23088
      K=4
      GOTO 23089
23088 CONTINUE
      IF(.NOT.(LDLY.GT.5.))GOTO 23090
      K=3
      GOTO 23091
23090 CONTINUE
      IF(.NOT.(LDLY.GT.0.))GOTO 23092
      K=2
      GOTO 23093
23092 CONTINUE
      K=1
23093 CONTINUE
23091 CONTINUE
23089 CONTINUE
23087 CONTINUE
23085 CONTINUE
      I_AML_ACCPNTR=(IAND(ISHFT(IBB(KPOINT_AML+9),-(12)),'01FFFF'X)+IBBP
     *(1,32))
      I=1 
23094 IF(.NOT.(I.LE.ICNT))GOTO 23096
      IF(.NOT.(I_AML_ACCPNTR.EQ.IACPNT(I)))GOTO 23097
      IF(.NOT.(K.EQ.5))GOTO 23099
      IQUANT(5,I) =IQUANT(5,I) +1
      GOTO 23100
23099 CONTINUE
      L =K
23101 IF(.NOT.(L.LE.6))GOTO 23103
      IF(.NOT.(L.EQ.5))GOTO 23104
      GOTO 23102
23104 CONTINUE
      IQUANT(L,I) =IQUANT(L,I) +1
23102 L=L+1
      GOTO 23101
23103 CONTINUE
23100 CONTINUE
      GOTO 23078
23097 CONTINUE
23095 I=I+1
      GOTO 23094
23096 CONTINUE
      IF(.NOT.(I.GT. 40))GOTO 23106
      GOTO 23078
23106 CONTINUE
      ICNT =I
      IACPNT(I) =I_AML_ACCPNTR
      L =K
23108 IF(.NOT.(L.LE.6))GOTO 23110
      IF(.NOT.(L.EQ.5))GOTO 23111
      GOTO 23109
23111 CONTINUE
      IQUANT(L,I) =1
23109 L=L+1
      GOTO 23108
23110 CONTINUE
      GOTO 23083
23082 CONTINUE
      IF(.NOT.(I_AML_STATUS.EQ.1))GOTO 23113
      I_AML_ACCPNTR=(IAND(ISHFT(IBB(KPOINT_AML+9),-(12)),'01FFFF'X)+IBBP
     *(1,32))
      I=1
23115 IF(.NOT.(I.LE.ICNT))GOTO 23117
      IF(.NOT.(I_AML_ACCPNTR.EQ.IACPNT(I)))GOTO 23118
      IQUANT(7,I) =IQUANT(7,I) +1
      GOTO 23078
23118 CONTINUE
23116 I=I+1
      GOTO 23115
23117 CONTINUE
      IF(.NOT.(I.GT. 40))GOTO 23120
      GOTO 23078
23120 CONTINUE
      ICNT =I
      IACPNT(I) =I_AML_ACCPNTR
      IQUANT(7,I) =1
      GOTO 23114
23113 CONTINUE
      IF(.NOT.(I_AML_STATUS.EQ.0))GOTO 23122
      I_AML_ACCPNTR=(IAND(ISHFT(IBB(KPOINT_AML+9),-(12)),'01FFFF'X)+IBBP
     *(1,32))
      I=1
23124 IF(.NOT.(I.LE.ICNT))GOTO 23126
      IF(.NOT.(I_AML_ACCPNTR.EQ.IACPNT(I)))GOTO 23127
      IQUANT(8,I) =IQUANT(8,I) +1
      GOTO 23078
23127 CONTINUE
23125 I=I+1
      GOTO 23124
23126 CONTINUE
      IF(.NOT.(I.GT. 40))GOTO 23129
      GOTO 23078
23129 CONTINUE
      ICNT =I
      IACPNT(I) =I_AML_ACCPNTR
      IQUANT(8,I) =1
23122 CONTINUE
23114 CONTINUE
23083 CONTINUE
23078 KPOINT_AML=KPOINT_AML+10
      GOTO 23077
23079 CONTINUE
      RETURN
      END
      SUBROUTINE WRTINV(SUBROU,KPOINT_INV,INDEX_INV_EXP,IFIRST,NOROOM,I_
     *INV_EXP_TYPE,I_INV_EXP_PNTR,I_INV_EXP_REMAINING)
      IMPLICIT NONE
      INTEGER*4 IBB(10240000)
      INTEGER*2 IBBW(2,10240000)
      BYTE IBBB(4,10240000)
      REAL*8 CBB(5120000)
      REAL FBB(10240000)
      INTEGER IBBP(6,170)
      EQUIVALENCE (IBB,FBB,CBB,IBBW,IBBB)
      EQUIVALENCE (IBB(1025),IBBP)
      COMMON /BBOARD/ IBB
cpar$ private / BBoard / ! keep FORTRAN from assigning a global section
      INTEGER ISNAP_D , ISNAP_BEFORE_1 , ISNAP_BEFORE_2 , ISNAP_AFTER_1 
     *, ISNAP_AFTER_2
      COMMON / SNAP_COMMON / ISNAP_D , ISNAP_BEFORE_1 , ISNAP_BEFORE_2 ,
     * ISNAP_AFTER_1 , ISNAP_AFTER_2
cpar$ private / snap_common / ! no FORTRAN global section
      INTEGER IFIRST,NOROOM,KPOINT_INV,I_INV_EXP_REMAINING,INDEX_INV_EXP
     *,I_INV_EXP_TYPE,I_INV_EXP_PNTR
      INDEX_INV_EXP=INDEX_INV_EXP+1
      IF(.NOT.(INDEX_INV_EXP.GT.10))GOTO 23131
      INDEX_INV_EXP=1
23131 CONTINUE
      IF(.NOT.(INDEX_INV_EXP.EQ.1))GOTO 23133
      CALL SUBROU(KPOINT_INV,IFIRST, 3,NOROOM)
      IF(.NOT.(NOROOM.NE.0))GOTO 23135
      RETURN
23135 CONTINUE
23133 CONTINUE
      IBB((KPOINT_INV+1+(INDEX_INV_EXP-1)*2))=IOR(IAND(IBB((KPOINT_INV+1
     *+(INDEX_INV_EXP-1)*2)),NOT(ISHFT('000F'X,20))),ISHFT(IAND((I_INV_E
     *XP_TYPE),'000F'X),20))
      IBB((KPOINT_INV+1+(INDEX_INV_EXP-1)*2))=IOR(IAND(IBB((KPOINT_INV+1
     *+(INDEX_INV_EXP-1)*2)),NOT(ISHFT('0FFFFF'X,0))),ISHFT(IAND((I_INV_
     *EXP_PNTR-IBBP(1,34)),'0FFFFF'X),0))
      IBB((KPOINT_INV+1+(INDEX_INV_EXP-1)*2)+1)=IOR(IAND(IBB((KPOINT_INV
     *+1+(INDEX_INV_EXP-1)*2)+1),NOT(ISHFT('07FFFF'X,11))),ISHFT(IAND((I
     *_INV_EXP_REMAINING),'07FFFF'X),11))
      IF(.NOT.(I_INV_EXP_REMAINING.NE.(IAND(ISHFT(IBB((KPOINT_INV+1+(IND
     *EX_INV_EXP-1)*2)+1),-(11)),'07FFFF'X))))GOTO 23137
      IBB((KPOINT_INV+1+(INDEX_INV_EXP-1)*2)+1)=IOR(IAND(IBB((KPOINT_INV
     *+1+(INDEX_INV_EXP-1)*2)+1),NOT(ISHFT('07FFFF'X,11))),ISHFT(IAND((-
     *1),'07FFFF'X),11))
23137 CONTINUE
      RETURN
      END
      SUBROUTINE UNTSTA(KPOINT_UNT,ISTAT)
      IMPLICIT NONE
      INTEGER*4 IBB(10240000)
      INTEGER*2 IBBW(2,10240000)
      BYTE IBBB(4,10240000)
      REAL*8 CBB(5120000)
      REAL FBB(10240000)
      INTEGER IBBP(6,170)
      EQUIVALENCE (IBB,FBB,CBB,IBBW,IBBB)
      EQUIVALENCE (IBB(1025),IBBP)
      COMMON /BBOARD/ IBB
cpar$ private / BBoard / ! keep FORTRAN from assigning a global section
      INTEGER ISNAP_D , ISNAP_BEFORE_1 , ISNAP_BEFORE_2 , ISNAP_AFTER_1 
     *, ISNAP_AFTER_2
      COMMON / SNAP_COMMON / ISNAP_D , ISNAP_BEFORE_1 , ISNAP_BEFORE_2 ,
     * ISNAP_AFTER_1 , ISNAP_AFTER_2
cpar$ private / snap_common / ! no FORTRAN global section
      REAL F_UNT_TIMEBINGO
      INTEGER ISTAT,KPOINT_UNT,I_UNT_TYPE,I_UNT_STATUS,I_UNT_ENGAGESTATU
     *S,I_UNT_MARSHALLSTATUS,I_UNT_ASWINDX,I_UNT_ATTACKINDX,I_UNT_SYSFAI
     *LTYPE
      I_UNT_TYPE=(IAND(ISHFT(IBB(KPOINT_UNT+16),-(20)),'00FF'X))
      I_UNT_STATUS=(IAND(ISHFT(IBB(KPOINT_UNT+15),-(16)),'00FF'X))
      I_UNT_ENGAGESTATUS=(IAND(ISHFT(IBB(KPOINT_UNT+42),-(30)),'0003'X))
      I_UNT_ATTACKINDX=(IAND(ISHFT(IBB(KPOINT_UNT+67),-(16)),'FFFF'X))
      IF(.NOT.(I_UNT_TYPE.EQ.1))GOTO 23139
      I_UNT_MARSHALLSTATUS=(IAND(ISHFT(IBB(KPOINT_UNT+40),-(30)),       
     *'0003'X))
      I_UNT_SYSFAILTYPE=(IAND(ISHFT(IBB(KPOINT_UNT+45),-(2)),'0007'X))
      I_UNT_ASWINDX=(IAND(ISHFT(IBB(KPOINT_UNT+61),-(21)),'03FF'X))
      IF(.NOT.(I_UNT_SYSFAILTYPE.NE.0))GOTO 23141
      ISTAT =8
      GOTO 23142
23141 CONTINUE
      IF(.NOT.(I_UNT_MARSHALLSTATUS.EQ.3))GOTO 23143
      ISTAT =0
      GOTO 23144
23143 CONTINUE
      IF(.NOT.(I_UNT_MARSHALLSTATUS.EQ.0))GOTO 23145
      ISTAT =5
      GOTO 23146
23145 CONTINUE
      IF(.NOT.(I_UNT_MARSHALLSTATUS.EQ.2))GOTO 23147
      ISTAT =5
      GOTO 23148
23147 CONTINUE
      IF(.NOT.(I_UNT_ENGAGESTATUS.EQ.2))GOTO 23149
      ISTAT =1
      GOTO 23150
23149 CONTINUE
      IF(.NOT.(I_UNT_ASWINDX.NE.0))GOTO 23151
      ISTAT =13
      GOTO 23152
23151 CONTINUE
      IF(.NOT.(I_UNT_STATUS.EQ.4))GOTO 23153
      ISTAT =5
      GOTO 23154
23153 CONTINUE
      IF(.NOT.(I_UNT_STATUS.EQ.5))GOTO 23155
      ISTAT =3
      GOTO 23156
23155 CONTINUE
      IF(.NOT.(I_UNT_STATUS.EQ.7))GOTO 23157
      ISTAT =0
      GOTO 23158
23157 CONTINUE
      IF(.NOT.(I_UNT_STATUS.EQ.9))GOTO 23159
      ISTAT =0
      GOTO 23160
23159 CONTINUE
      IF(.NOT.(I_UNT_ATTACKINDX.NE.0.AND.I_UNT_STATUS.NE.8.AND.I_UNT_STA
     *TUS.NE.5))GOTO 23161
      ISTAT =4
      GOTO 23162
23161 CONTINUE
      IF(.NOT.(I_UNT_STATUS.EQ.2))GOTO 23163
      ISTAT =7
      GOTO 23164
23163 CONTINUE
      IF(.NOT.(I_UNT_STATUS.EQ.6))GOTO 23165
      ISTAT =7
      GOTO 23166
23165 CONTINUE
      IF(.NOT.(I_UNT_STATUS.EQ.3))GOTO 23167
      ISTAT =2
      GOTO 23168
23167 CONTINUE
      ISTAT =2
23168 CONTINUE
23166 CONTINUE
23164 CONTINUE
23162 CONTINUE
23160 CONTINUE
23158 CONTINUE
23156 CONTINUE
23154 CONTINUE
23152 CONTINUE
23150 CONTINUE
23148 CONTINUE
23146 CONTINUE
23144 CONTINUE
23142 CONTINUE
      IF(.NOT.(ISTAT.EQ.0))GOTO 23169
      F_UNT_TIMEBINGO=(IAND(ISHFT(IBB(KPOINT_UNT+40),-(0)),'07FFFFFF'X)*
     *1.0*0.001)
      IF(.NOT.(F_UNT_TIMEBINGO.GT.0.AND.F_UNT_TIMEBINGO.LE.(FBB(461)+FBB
     *(458))))GOTO 23171
      ISTAT =14
23171 CONTINUE
23169 CONTINUE
      GOTO 23140
23139 CONTINUE
      IF(.NOT.(I_UNT_TYPE.EQ.3.OR.I_UNT_TYPE.EQ.4))GOTO 23173
      IF(.NOT.(I_UNT_ENGAGESTATUS.EQ.2))GOTO 23175
      ISTAT =1
      GOTO 23176
23175 CONTINUE
      IF(.NOT.(I_UNT_STATUS.EQ.0))GOTO 23177
      ISTAT =6
      GOTO 23178
23177 CONTINUE
      IF(.NOT.(I_UNT_STATUS.EQ.13))GOTO 23179
      ISTAT =11
      GOTO 23180
23179 CONTINUE
      IF(.NOT.(I_UNT_STATUS.EQ.12))GOTO 23181
      ISTAT =12
      GOTO 23182
23181 CONTINUE
      IF(.NOT.(I_UNT_STATUS.EQ.14))GOTO 23183
      ISTAT =10
      GOTO 23184
23183 CONTINUE
      IF(.NOT.(I_UNT_STATUS.EQ.4))GOTO 23185
      ISTAT =5
      GOTO 23186
23185 CONTINUE
      IF(.NOT.(I_UNT_STATUS.EQ.7))GOTO 23187
      ISTAT =17
      GOTO 23188
23187 CONTINUE
      IF(.NOT.(I_UNT_STATUS.EQ.20))GOTO 23189
      ISTAT =18
      GOTO 23190
23189 CONTINUE
      IF(.NOT.(I_UNT_STATUS.EQ.9))GOTO 23191
      ISTAT =12
      GOTO 23192
23191 CONTINUE
      IF(.NOT.(I_UNT_STATUS.EQ.1))GOTO 23193
      ISTAT =6
      GOTO 23194
23193 CONTINUE
      IF(.NOT.(I_UNT_STATUS.EQ.19))GOTO 23195
      ISTAT =3
      GOTO 23196
23195 CONTINUE
      IF(.NOT.(I_UNT_ATTACKINDX.NE.0))GOTO 23197
      ISTAT =4
      GOTO 23198
23197 CONTINUE
      IF(.NOT.(I_UNT_STATUS.EQ.2))GOTO 23199
      ISTAT =7
      GOTO 23200
23199 CONTINUE
      IF(.NOT.(I_UNT_STATUS.EQ.6))GOTO 23201
      ISTAT =7
      GOTO 23202
23201 CONTINUE
      IF(.NOT.(I_UNT_STATUS.EQ.10))GOTO 23203
      ISTAT =9
      GOTO 23204
23203 CONTINUE
      IF(.NOT.(I_UNT_STATUS.EQ.16))GOTO 23205
      ISTAT =15
      GOTO 23206
23205 CONTINUE
      ISTAT =2
23206 CONTINUE
23204 CONTINUE
23202 CONTINUE
23200 CONTINUE
23198 CONTINUE
23196 CONTINUE
23194 CONTINUE
23192 CONTINUE
23190 CONTINUE
23188 CONTINUE
23186 CONTINUE
23184 CONTINUE
23182 CONTINUE
23180 CONTINUE
23178 CONTINUE
23176 CONTINUE
      GOTO 23174
23173 CONTINUE
      IF(.NOT.(I_UNT_ENGAGESTATUS.EQ.2))GOTO 23207
      ISTAT =1
      GOTO 23208
23207 CONTINUE
      IF(.NOT.(I_UNT_STATUS.EQ.0))GOTO 23209
      ISTAT =6
      GOTO 23210
23209 CONTINUE
      IF(.NOT.(I_UNT_STATUS.EQ.13))GOTO 23211
      ISTAT =11
      GOTO 23212
23211 CONTINUE
      IF(.NOT.(I_UNT_STATUS.EQ.12))GOTO 23213
      ISTAT =12
      GOTO 23214
23213 CONTINUE
      IF(.NOT.(I_UNT_STATUS.EQ.14))GOTO 23215
      ISTAT =10
      GOTO 23216
23215 CONTINUE
      IF(.NOT.(I_UNT_STATUS.EQ.4))GOTO 23217
      ISTAT =5
      GOTO 23218
23217 CONTINUE
      IF(.NOT.(I_UNT_STATUS.EQ.7))GOTO 23219
      ISTAT =2
      GOTO 23220
23219 CONTINUE
      IF(.NOT.(I_UNT_STATUS.EQ.9))GOTO 23221
      ISTAT =12
      GOTO 23222
23221 CONTINUE
      IF(.NOT.(I_UNT_STATUS.EQ.1))GOTO 23223
      ISTAT =6
      GOTO 23224
23223 CONTINUE
      IF(.NOT.(I_UNT_ATTACKINDX.NE.0))GOTO 23225
      ISTAT =4
      GOTO 23226
23225 CONTINUE
      IF(.NOT.(I_UNT_STATUS.EQ.2))GOTO 23227
      ISTAT =7
      GOTO 23228
23227 CONTINUE
      IF(.NOT.(I_UNT_STATUS.EQ.6))GOTO 23229
      ISTAT =7
      GOTO 23230
23229 CONTINUE
      IF(.NOT.(I_UNT_STATUS.EQ.10))GOTO 23231
      ISTAT =9
      GOTO 23232
23231 CONTINUE
      IF(.NOT.(I_UNT_STATUS.EQ.16))GOTO 23233
      ISTAT =15
      GOTO 23234
23233 CONTINUE
      ISTAT =2
23234 CONTINUE
23232 CONTINUE
23230 CONTINUE
23228 CONTINUE
23226 CONTINUE
23224 CONTINUE
23222 CONTINUE
23220 CONTINUE
23218 CONTINUE
23216 CONTINUE
23214 CONTINUE
23212 CONTINUE
23210 CONTINUE
23208 CONTINUE
23174 CONTINUE
23140 CONTINUE
      RETURN
      END
      SUBROUTINE UDDET(IDEPLY,DTIME,ISTAT)
      IMPLICIT NONE
      INTEGER*4 IBB(10240000)
      INTEGER*2 IBBW(2,10240000)
      BYTE IBBB(4,10240000)
      REAL*8 CBB(5120000)
      REAL FBB(10240000)
      INTEGER IBBP(6,170)
      EQUIVALENCE (IBB,FBB,CBB,IBBW,IBBB)
      EQUIVALENCE (IBB(1025),IBBP)
      COMMON /BBOARD/ IBB
cpar$ private / BBoard / ! keep FORTRAN from assigning a global section
      INTEGER ISNAP_D , ISNAP_BEFORE_1 , ISNAP_BEFORE_2 , ISNAP_AFTER_1 
     *, ISNAP_AFTER_2
      COMMON / SNAP_COMMON / ISNAP_D , ISNAP_BEFORE_1 , ISNAP_BEFORE_2 ,
     * ISNAP_AFTER_1 , ISNAP_AFTER_2
cpar$ private / snap_common / ! no FORTRAN global section
      REAL DTIME
      INTEGER IDEPLY,ISTAT
      IF(.NOT.(IDEPLY.EQ.1))GOTO 23235
      IF(.NOT.(DTIME.LE.FBB(461)))GOTO 23237
      ISTAT =1
      GOTO 23238
23237 CONTINUE
      ISTAT =3
23238 CONTINUE
      GOTO 23236
23235 CONTINUE
      IF(.NOT.(DTIME.LE.FBB(461)))GOTO 23239
      ISTAT =0
      GOTO 23240
23239 CONTINUE
      ISTAT =2
23240 CONTINUE
23236 CONTINUE
      RETURN
      END
      SUBROUTINE CMEAS(INDX_UNT,IBLIP,IJAM,IRBOC,IDECM)
      IMPLICIT NONE
      INTEGER*4 IBB(10240000)
      INTEGER*2 IBBW(2,10240000)
      BYTE IBBB(4,10240000)
      REAL*8 CBB(5120000)
      REAL FBB(10240000)
      INTEGER IBBP(6,170)
      EQUIVALENCE (IBB,FBB,CBB,IBBW,IBBB)
      EQUIVALENCE (IBB(1025),IBBP)
      COMMON /BBOARD/ IBB
cpar$ private / BBoard / ! keep FORTRAN from assigning a global section
      INTEGER ISNAP_D , ISNAP_BEFORE_1 , ISNAP_BEFORE_2 , ISNAP_AFTER_1 
     *, ISNAP_AFTER_2
      COMMON / SNAP_COMMON / ISNAP_D , ISNAP_BEFORE_1 , ISNAP_BEFORE_2 ,
     * ISNAP_AFTER_1 , ISNAP_AFTER_2
cpar$ private / snap_common / ! no FORTRAN global section
      INTEGER INDX_UNT,IBLIP,IJAM,IDECM,IRBOC,KPOINT_DEQ,I_DEQ_IDENT,IND
     *EX_DEQ_EM
      IBLIP =0
      IJAM =0
      IRBOC =0
      IDECM =0
      KPOINT_DEQ=IBBP(1,03)-6+(6)*INDX_UNT
23241 IF(.NOT.(KPOINT_DEQ.GE.IBBP(1,03)))GOTO 23243
      I_DEQ_IDENT=(IAND(ISHFT(IBB(KPOINT_DEQ+2),-(0)),'00FF'X))
      IF(.NOT.(I_DEQ_IDENT.EQ.19))GOTO 23244
      IF(.NOT.((IAND(ISHFT(IBB(KPOINT_DEQ+1),-(11)),'0003'X)).NE.0))GOTO
     * 23246
      IBLIP =1
23246 CONTINUE
      GOTO 23245
23244 CONTINUE
      IF(.NOT.(I_DEQ_IDENT.EQ.18))GOTO 23248
      IF(.NOT.((IAND(ISHFT(IBB(KPOINT_DEQ+1),-(11)),'0003'X)).NE.0))GOTO
     * 23250
      IDECM =1
23250 CONTINUE
      GOTO 23249
23248 CONTINUE
      IF(.NOT.(I_DEQ_IDENT.EQ.17))GOTO 23252
      IF(.NOT.((IAND(ISHFT(IBB(KPOINT_DEQ+1),-(11)),'0003'X)).NE.0.AND.(
     *IAND(ISHFT(IBB(KPOINT_DEQ+1),-(13)),'07FFFF'X)).GT.0))GOTO 23254
      IRBOC =1
23254 CONTINUE
      GOTO 23253
23252 CONTINUE
      IF(.NOT.(I_DEQ_IDENT.EQ.4))GOTO 23256
      INDEX_DEQ_EM=1
23258 IF(.NOT.((INDEX_DEQ_EM.GT.0.AND.INDEX_DEQ_EM.LE.10)))GOTO 23260
      IF(.NOT.((IAND(ISHFT(IBB(KPOINT_DEQ+1),-((INDEX_DEQ_EM))),'0001'X)
     *).NE.0))GOTO 23261
      IJAM =1
      GOTO 23260
23261 CONTINUE
23259 INDEX_DEQ_EM=INDEX_DEQ_EM+1
      GOTO 23258
23260 CONTINUE
23256 CONTINUE
23253 CONTINUE
23249 CONTINUE
23245 CONTINUE
23242 KPOINT_DEQ=IBBP(1,03)-6+(6)*(IAND(ISHFT(IBB(KPOINT_DEQ+2),-(8)),  
     *'0FFFFF'X))
      GOTO 23241
23243 CONTINUE
      RETURN
      END
