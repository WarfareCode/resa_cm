      SUBROUTINE BBWRTR
      IMPLICIT NONE
      INTEGER*4 IBB(10240000)
      INTEGER*2 IBBW(2,10240000)
      BYTE IBBB(4,10240000)
      REAL*8 CBB(5120000)
      REAL FBB(10240000)
      INTEGER IBBP(6,170)
      EQUIVALENCE (IBB,FBB,CBB,IBBW,IBBB)
      EQUIVALENCE (IBB(1025),IBBP)
      COMMON /BBOARD/ IBB
cpar$ private / BBoard / ! keep FORTRAN from assigning a global section
      INTEGER ISNAP_D , ISNAP_BEFORE_1 , ISNAP_BEFORE_2 , ISNAP_AFTER_1 
     *, ISNAP_AFTER_2
      COMMON / SNAP_COMMON / ISNAP_D , ISNAP_BEFORE_1 , ISNAP_BEFORE_2 ,
     * ISNAP_AFTER_1 , ISNAP_AFTER_2
cpar$ private / snap_common / ! no FORTRAN global section
      INTEGER ISLEEP,I
      ISLEEP =12000
      I =0
23000 CONTINUE
      I =I +1
      IF(.NOT.(IBB(139).LE.0))GOTO 23003
      IBB(138)=1
      IBB(139)=0
      GOTO 23002
23003 CONTINUE
      CALL DELAY (ISLEEP)
      IF(.NOT.(I.GE.6))GOTO 23005
      CALL ECHOV ('Overriding Read Locks. ')
      IBB(138)=1
      IBB(139)=0
      GOTO 23002
23005 CONTINUE
      IF(.NOT.(ISLEEP.LE.1000))GOTO 23007
      GOTO 23001
23007 CONTINUE
      ISLEEP =ISLEEP / 2
23001 GOTO 23000
23002 CONTINUE
      RETURN
      END
      SUBROUTINE BBSAVR
      IMPLICIT NONE
      INTEGER*4 IBB(10240000)
      INTEGER*2 IBBW(2,10240000)
      BYTE IBBB(4,10240000)
      REAL*8 CBB(5120000)
      REAL FBB(10240000)
      INTEGER IBBP(6,170)
      EQUIVALENCE (IBB,FBB,CBB,IBBW,IBBB)
      EQUIVALENCE (IBB(1025),IBBP)
      COMMON /BBOARD/ IBB
cpar$ private / BBoard / ! keep FORTRAN from assigning a global section
      INTEGER ISNAP_D , ISNAP_BEFORE_1 , ISNAP_BEFORE_2 , ISNAP_AFTER_1 
     *, ISNAP_AFTER_2
      COMMON / SNAP_COMMON / ISNAP_D , ISNAP_BEFORE_1 , ISNAP_BEFORE_2 ,
     * ISNAP_AFTER_1 , ISNAP_AFTER_2
cpar$ private / snap_common / ! no FORTRAN global section
      INTEGER ISLEEP,I
      ISLEEP =4000
      I =0
23009 CONTINUE
      I =I +1
      IF(.NOT.(IBB(176).LE.0))GOTO 23012
      IBB(175)=1
      IBB(176)=0
      GOTO 23011
23012 CONTINUE
      CALL DELAY (ISLEEP)
      IF(.NOT.(I.GE.5))GOTO 23014
      CALL ECHOV ('Overriding Write Locks. ')
      IBB(175)=1
      IBB(176)=0
      GOTO 23011
23014 CONTINUE
      IF(.NOT.(ISLEEP.LE.1000))GOTO 23016
      GOTO 23010
23016 CONTINUE
      ISLEEP =ISLEEP / 2
23010 GOTO 23009
23011 CONTINUE
      RETURN
      END
      SUBROUTINE BBRDRQ (IVIEW)
      IMPLICIT NONE
      INTEGER*4 IBB(10240000)
      INTEGER*2 IBBW(2,10240000)
      BYTE IBBB(4,10240000)
      REAL*8 CBB(5120000)
      REAL FBB(10240000)
      INTEGER IBBP(6,170)
      EQUIVALENCE (IBB,FBB,CBB,IBBW,IBBB)
      EQUIVALENCE (IBB(1025),IBBP)
      COMMON /BBOARD/ IBB
cpar$ private / BBoard / ! keep FORTRAN from assigning a global section
      INTEGER ISNAP_D , ISNAP_BEFORE_1 , ISNAP_BEFORE_2 , ISNAP_AFTER_1 
     *, ISNAP_AFTER_2
      COMMON / SNAP_COMMON / ISNAP_D , ISNAP_BEFORE_1 , ISNAP_BEFORE_2 ,
     * ISNAP_AFTER_1 , ISNAP_AFTER_2
cpar$ private / snap_common / ! no FORTRAN global section
      INTEGER LVIEW
      INTEGER IVIEW
      IBB(139)=IBB(139)+1
23018 CONTINUE
      IBB(138)=IBB(138)+1
      IF(.NOT.(IBB(138).EQ.0))GOTO 23021
      IBB(138)=-1
      GOTO 23020
23021 CONTINUE
      CALL DELAY (2000)
23019 GOTO 23018
23020 CONTINUE
      LVIEW =IVIEW
      RETURN
      ENTRY BBRDX (IVIEW)
      IF(.NOT.(IVIEW.NE.LVIEW))GOTO 23023
      RETURN
23023 CONTINUE
      LVIEW =-1
      IF(.NOT.(IBB(139).GT.0))GOTO 23025
      IBB(139)=IBB(139)-1
23025 CONTINUE
      RETURN
      END
      SUBROUTINE BBWTRQ (IVIEW)
      IMPLICIT NONE
      INTEGER*4 IBB(10240000)
      INTEGER*2 IBBW(2,10240000)
      BYTE IBBB(4,10240000)
      REAL*8 CBB(5120000)
      REAL FBB(10240000)
      INTEGER IBBP(6,170)
      EQUIVALENCE (IBB,FBB,CBB,IBBW,IBBB)
      EQUIVALENCE (IBB(1025),IBBP)
      COMMON /BBOARD/ IBB
cpar$ private / BBoard / ! keep FORTRAN from assigning a global section
      INTEGER ISNAP_D , ISNAP_BEFORE_1 , ISNAP_BEFORE_2 , ISNAP_AFTER_1 
     *, ISNAP_AFTER_2
      COMMON / SNAP_COMMON / ISNAP_D , ISNAP_BEFORE_1 , ISNAP_BEFORE_2 ,
     * ISNAP_AFTER_1 , ISNAP_AFTER_2
cpar$ private / snap_common / ! no FORTRAN global section
      INTEGER LVIEW
      INTEGER IVIEW
      IBB(176)=IBB(176)+1
23027 CONTINUE
      IBB(175)=IBB(175)+1
      IF(.NOT.(IBB(175).EQ.0))GOTO 23030
      IBB(175)=-1
      GOTO 23029
23030 CONTINUE
      CALL DELAY (2000)
23028 GOTO 23027
23029 CONTINUE
      LVIEW =IVIEW
      RETURN
      ENTRY BBWTX (IVIEW)
      IF(.NOT.(IVIEW.NE.LVIEW))GOTO 23032
      RETURN
23032 CONTINUE
      LVIEW =-1
      IF(.NOT.(IBB(176).GT.0))GOTO 23034
      IBB(176)=IBB(176)-1
23034 CONTINUE
      RETURN
      END
